# Lab 10 - Microsoft Defender for Endpoint Incidents Management and Analysis

**Objective**

- To manage and analyze incidents and alerts generated by Defender for
  Endpoint.

**Exercise 1: Incident Management and Analysis**

1.  In **Microsoft Defender** page, navigate and click on **Incidents &
    alerts**, then click on **Incidents**.

<img src="./media/image1.png" style="width:6.5in;height:3.39097in" />

2.  On the **Incidents** page, select the **Multi-stage incident
    involving initial access…** then click on **Customize columns** in
    the command bar.

<img src="./media/image2.png" style="width:6.5in;height:4.02014in"
alt="A screenshot of a computer Description automatically generated" />

3.  In the **Customize columns** pane that appears on the right side,
    select **Incident name**, **Investigation state**, **Service
    sources** check boxes, then click on the **Apply** button.

<img src="./media/image3.png" style="width:6.5in;height:3.62778in"
alt="A screenshot of a computer Description automatically generated" />

4.  Review the **Investigation state** and **service sources** of the
    Incident.

<img src="./media/image4.png" style="width:6.5in;height:3.93819in" />

5.  Click on the **Multi-stage incident involving Execution & Discovery
    on multiple endpoints** Incident row. The incident details were
    appear on the right pane, carefully review it. Then, click on the
    **Close** button.

<img src="./media/image5.png" style="width:6.5in;height:3.77083in" />

<img src="./media/image6.png" style="width:6.5in;height:3.50903in"
alt="A screenshot of a computer Description automatically generated" />

6.  In the **Attack story** tab, review the **Incident graph**.

<img src="./media/image7.png" style="width:6.5in;height:3.62708in" />

7.  Click on the **Layout** dropdown and select **Align by entities
    types**.

<img src="./media/image8.png" style="width:6.5in;height:3.56458in"
alt="A screenshot of a computer Description automatically generated" />

8.  All the entities align in their respective layers.

<img src="./media/image9.png" style="width:6.5in;height:3.42986in" />

9.  Then, click on the **Alerts** tab and review the generated alerts.

<img src="./media/image10.png" style="width:6.5in;height:3.44444in"
alt="A screenshot of a computer Description automatically generated" />

10. Now, click on the **Assets** tab and check all the assets that are
    affected by the incident.

<img src="./media/image11.png" style="width:6.5in;height:3.42639in"
alt="A screenshot of a computer Description automatically generated" />

11. Click on the **Investigations** tab and review the status of all the
    Investigations. Open any triggered alerts to review it. Here, we are
    opening **‘Filecoder’ ransomware was prevented**

<img src="./media/image12.png" style="width:6.5in;height:3.31736in"
alt="A screenshot of a computer Description automatically generated" />

12. Carefully review the **Investigation graph**.

<img src="./media/image13.png" style="width:6.5in;height:3.39653in"
alt="A screenshot of a computer Description automatically generated" />

13. Click on the **Alerts** tab and review them.

<img src="./media/image14.png" style="width:6.5in;height:3.22639in"
alt="A screenshot of a computer Description automatically generated" />

14. Click on the **Devices** tab to know about the comprised devices.

<img src="./media/image15.png" style="width:6.5in;height:3.33403in"
alt="A screenshot of a computer Description automatically generated" />

15. Click on the **Evidence** tab. Review all the suspicious entities,
    click on any entity to get further evidence (here, we clicked on
    **lockysample.exe**). Review the entity carefully and then close the
    pane.

<img src="./media/image16.png" style="width:6.5in;height:3.35833in" />

<img src="./media/image17.png" style="width:6.5in;height:3.36667in" />

16. Click on **Entities** tab.

<img src="./media/image18.png" style="width:6.5in;height:3.42778in"
alt="A screenshot of a computer Description automatically generated" />

17. Navigate to **Evidence summary** section and click on Files, then
    carefully review the **Verdict** and **File name**.

<img src="./media/image19.png" style="width:6.5in;height:3.41528in" />

18. Click on the **Processes** and review the **Verdict** and **Process
    name.**

<img src="./media/image20.png" style="width:6.5in;height:3.43542in"
alt="A screenshot of a computer Description automatically generated" />

19. Click on **Services** and carefully review the **Verdict** and
    **Service Name**.

<img src="./media/image21.png" style="width:6.5in;height:3.44514in" />

20. Click on **Drivers**, then review the **Name** of the driver and
    associated **Verdict**.

<img src="./media/image22.png" style="width:6.5in;height:3.43681in"
alt="A screenshot of a computer Description automatically generated" />

21. Click on **IP Addresses** and check whether there is any threat
    associated with any specific IP address.

<img src="./media/image23.png" style="width:6.5in;height:3.39722in"
alt="A screenshot of a computer Description automatically generated" />

22. Click on **Persistence Methods** and review it carefully.

<img src="./media/image24.png" style="width:6.5in;height:3.44653in"
alt="A screenshot of a computer Description automatically generated" />

23. Click on the Log tab and review the **Action** and **Status**.

<img src="./media/image25.png" style="width:6.5in;height:3.45208in" />

24. Now, click on **Incidents** in the left-sided navigation menu, then
    click on **Multi-state incident involving Execution & Credential…**

<img src="./media/image26.png" style="width:6.5in;height:3.25208in"
alt="A screenshot of a computer Description automatically generated" />

25. Click on the **Summary** tab. In case, you did not see the
    **Summary** tab, then click on the horizontal ellipsis and select
    **Summary** as shown in the below image.

<img src="./media/image27.png" style="width:6.5in;height:3.41042in"
alt="A screenshot of a computer Description automatically generated" />

26. Carefully review the entire Summary of the multi-stage incident
    attack.

<img src="./media/image28.png" style="width:6.5in;height:3.38056in"
alt="A screenshot of a computer Description automatically generated" />

<img src="./media/image29.png" style="width:6.5in;height:3.52639in"
alt="A screenshot of a computer Description automatically generated" />

<img src="./media/image30.png" style="width:6.5in;height:3.32153in"
alt="A screenshot of a computer Description automatically generated" />

<img src="./media/image31.png" style="width:6.5in;height:3.43542in"
alt="A screenshot of a computer Description automatically generated" />

**Summary**

In this lab, you’ve learned how to effectively manage and analyze
security incidents and alerts. You’ve interpreted the Attack story by
examining the incident graph and aligning entities by types. Then, you
reviewed generated alerts, identified affected assets, and checked the
status of ongoing investigations. By investigating a specific ransomware
alert, you’ve understood how to analyze the investigation graph and
scrutinize the evidence linked to suspicious entities. You’ve explored
various tabs to review files, processes, services, drivers, IP
addresses, and persistence methods, gaining insights into identifying
and evaluating potential threats. Then, you’ve carefully reviewed the
summary of a multi-stage incident for better security management.
