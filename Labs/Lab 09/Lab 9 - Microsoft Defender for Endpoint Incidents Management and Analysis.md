# Lab 9 - Microsoft Defender for Endpoint Incidents Management and Analysis

**Objective**

- To manage and analyze incidents and alerts generated by Defender for
  Endpoint.

**Exercise 1: Incident Management and Analysis**

1.  In **Microsoft Defender** page, navigate and click on **Incidents &
    alerts**, then click on **Incidents**.

![](./media/image1.png)

2.  On the **Incidents** page, select the **Multi-stage incident
    involving initial access…** then click on **Customize columns** in
    the command bar.

![A screenshot of a computer Description automatically
generated](./media/image2.png)

3.  In the **Customize columns** pane that appears on the right side,
    select **Incident name**, **Investigation state**, **Service
    sources** check boxes, then click on the **Apply** button.

![A screenshot of a computer Description automatically
generated](./media/image3.png)

4.  Review the **Investigation state** and **service sources** of the
    Incident.

![](./media/image4.png)

5.  Click on the **Multi-stage incident involving Execution & Discovery
    on multiple endpoints** Incident row. The incident details were
    appear on the right pane, carefully review it. Then, click on the
    **Close** button.

![](./media/image5.png)

![A screenshot of a computer Description automatically
generated](./media/image6.png)

6.  In the **Attack story** tab, review the **Incident graph**.

![](./media/image7.png)

7.  Click on the **Layout** dropdown and select **Align by entities
    types**.

![A screenshot of a computer Description automatically
generated](./media/image8.png)

8.  All the entities align in their respective layers.

![](./media/image9.png)

9.  Then, click on the **Alerts** tab and review the generated alerts.

![A screenshot of a computer Description automatically
generated](./media/image10.png)

10. Now, click on the **Assets** tab and check all the assets that are
    affected by the incident.

![A screenshot of a computer Description automatically
generated](./media/image11.png)

11. Click on the **Investigations** tab and review the status of all the
    Investigations. Open any triggered alerts to review it. Here, we are
    opening **‘Filecoder’ ransomware was prevented**

![A screenshot of a computer Description automatically
generated](./media/image12.png)

12. Carefully review the **Investigation graph**.

![A screenshot of a computer Description automatically
generated](./media/image13.png)

13. Click on the **Alerts** tab and review them.

![A screenshot of a computer Description automatically
generated](./media/image14.png)

14. Click on the **Devices** tab to know about the comprised devices.

![A screenshot of a computer Description automatically
generated](./media/image15.png)

15. Click on the **Evidence** tab. Review all the suspicious entities,
    click on any entity to get further evidence (here, we clicked on
    **lockysample.exe**). Review the entity carefully and then close the
    pane.

![](./media/image16.png)

![](./media/image17.png)

16. Click on **Entities** tab.

![A screenshot of a computer Description automatically
generated](./media/image18.png)

17. Navigate to **Evidence summary** section and click on Files, then
    carefully review the **Verdict** and **File name**.

![](./media/image19.png)

18. Click on the **Processes** and review the **Verdict** and **Process
    name.**

![A screenshot of a computer Description automatically
generated](./media/image20.png)

19. Click on **Services** and carefully review the **Verdict** and
    **Service Name**.

![](./media/image21.png)

20. Click on **Drivers**, then review the **Name** of the driver and
    associated **Verdict**.

![A screenshot of a computer Description automatically
generated](./media/image22.png)

21. Click on **IP Addresses** and check whether there is any threat
    associated with any specific IP address.

![A screenshot of a computer Description automatically
generated](./media/image23.png)

22. Click on **Persistence Methods** and review it carefully.

![A screenshot of a computer Description automatically
generated](./media/image24.png)

23. Click on the Log tab and review the **Action** and **Status**.

![](./media/image25.png)

24. Now, click on **Incidents** in the left-sided navigation menu, then
    click on **Multi-state incident involving Execution & Credential…**

![A screenshot of a computer Description automatically
generated](./media/image26.png)

25. Click on the **Summary** tab. In case, you did not see the
    **Summary** tab, then click on the horizontal ellipsis and select
    **Summary** as shown in the below image.

![A screenshot of a computer Description automatically
generated](./media/image27.png)

26. Carefully review the entire Summary of the multi-stage incident
    attack.

![A screenshot of a computer Description automatically
generated](./media/image28.png)

![A screenshot of a computer Description automatically
generated](./media/image29.png)

![A screenshot of a computer Description automatically
generated](./media/image30.png)

![A screenshot of a computer Description automatically
generated](./media/image31.png)

**Summary**

In this lab, you’ve learned how to effectively manage and analyze
security incidents and alerts. You’ve interpreted the Attack story by
examining the incident graph and aligning entities by types. Then, you
reviewed generated alerts, identified affected assets, and checked the
status of ongoing investigations. By investigating a specific ransomware
alert, you’ve understood how to analyze the investigation graph and
scrutinize the evidence linked to suspicious entities. You’ve explored
various tabs to review files, processes, services, drivers, IP
addresses, and persistence methods, gaining insights into identifying
and evaluating potential threats. Then, you’ve carefully reviewed the
summary of a multi-stage incident for better security management.
